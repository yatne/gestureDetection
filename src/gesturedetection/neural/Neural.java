package gesturedetection.neural;

import org.neuroph.core.NeuralNetwork;

public class Neural {
    private static final String NETWORK_PATH = "c:/studia/AAATUTATUTA/NewNeuralNetwork3.nnet";

    NeuralNetwork neuralNetwork;

    public Neural() {
        neuralNetwork = NeuralNetwork.load(NETWORK_PATH);
        System.out.println("network loaded.");
    }

    public double[] getRespone(double[] in) {
        neuralNetwork.setInput(in);
        neuralNetwork.calculate();
        return neuralNetwork.getOutput();
    }

    private static void test(NeuralNetwork neuralNetwork) {
        checkAnswer(in1,neuralNetwork,out1);
        checkAnswer(in2,neuralNetwork,out2);
        checkAnswer(in3,neuralNetwork,out3);
        checkAnswer(in4,neuralNetwork,out4);
    }

    private static void checkAnswer(double[] in, NeuralNetwork nn, double[] out) {
        nn.setInput(in);
        nn.calculate();
        double out11 = nn.getOutput()[0]<=0.5? 0: 1;
        double out22 = nn.getOutput()[1]<=0.5? 0: 1;
        boolean ok = (out[0] == out11 && out[1] == out22);
        System.out.println(ok +  " out: " + nn.getOutput()[0] + nn.getOutput()[1] + " wanted: " + out[0] + out[1]);
    }

    private static double[] in1 = {0.01449350761275265, -0.10618298615271021, -0.11703689763467134, 0.0026164010229231473, 0.6703119090203974, 0.04887273505643573, 0.004906261727559812, 1.052300806763845, -0.05262912856175576, -0.38303916373995617, 0.5038492348980876, 0.009251849446221271, -0.9164646954728184, 0.5226200157459278, -0.08516325317744414, -1.3529520041460448, 0.6379302611667673, -0.19395090744976856, -1.528489521828778, 0.6986402502699497, -0.29901199936013323, 0.3727995145366309, 0.47480203301029494, 0.10235857676656948, 0.8604584426004764, 0.26720393098074197, 0.06214433107045449, 1.3014596635493327, 0.1906943603875888, -0.019208459654329116, 1.4057084977066006, 0.10692613557588879, -0.05702223053317172, -0.15251591543395718, -0.2654528224731105, -0.19192611859418968, -0.19793511300692196, -1.1144255611464693, -0.2379015038517584, -0.24049022949754065, -1.7512268999816962, -0.3455182857471919, 0.18586876510140068, -0.2834225322466136, -0.12743211887249828, 0.19570899306563713, -1.093304354216018, -0.2275734026864921, 0.23395420850811816, -1.6854094928571037, -0.49858654344492925};
    private static double[] out1 = {0.0, 1.0};
    private static double[] in2 = {0.001545008263472161, -0.1009570308252064, -0.14436776043495664, 0.02927614499327276, 0.7101188690808811, 0.08828139253644249, 0.040470418198991366, 1.127698360805434, 0.04787518151172279, -0.38765556455088457, 0.7070680853757674, 0.11078925889567526, -0.551666737106444, 1.1987235156687215, -0.046005541916131515, -0.4269470417413098, 1.7000393145327422, -8.544506749082302E-4, -0.39871576584480395, 1.7533904532823217, 0.04112699515840466, 0.47426619582126683, 0.651479301046849, 0.13064635418423565, 0.6928752155203888, 1.126674288981695, 0.005930959272168283, 0.6777747385702274, 1.6526459247629603, -0.03269359519675267, 0.6794539949935753, 1.8341500009088088, -0.01981197578097446, -0.20312266521025515, -0.2782990483001481, -0.21088914245040286, -0.2990253770710338, -1.3819469975497465, -0.3314163190708078, -0.37733264421061125, -2.237702401718746, -0.5823865300943895, 0.1927834066732896, -0.2941779182709019, -0.19950041474187358, 0.16953287498167346, -1.3789322389514707, -0.3010807821392639, 0.16257409861414038, -2.304133967714404, -0.4471518039855888};
    private static double[] out2 = {1.0, 0.0};
    private static double[] in3 = {0.025014312248673478, -0.16093786500296273, -0.1781636226111819, -0.02891930008546925, 1.02148976834193, 0.07413552993453461, -0.007438446771174948, 1.6160223893251489, -0.07714495875276156, -0.5591298956529911, 0.7646426728275701, 0.003613889800257329, -1.1433105858151096, 0.3544276863485461, -0.11424598695750154, -0.766680426146318, -0.18265907063604325, -0.24039878225334102, -0.6414868102815791, -0.36214034246277116, -0.26932635343952593, 0.5428215344458046, 0.7576091076135895, 0.13250714666078126, 1.052525866643797, 0.3661256605709769, 0.19762082818659746, 1.4956646625055892, 0.07563197324293243, 0.1651423169828992, 1.6981339652230496, 0.023323185112890204, 0.21460653945087105, -0.214602470963492, -0.40176987968777544, -0.2869601613306865, -0.33264149529188664, -1.675199700678405, -0.3197333919717771, -0.4103016765562546, -2.7097532702228353, -0.4120785772418918, 0.28345290166668236, -0.4120752017386268, -0.19184232426607514, 0.2912249867572657, -1.6589490890788166, -0.28862761523496205, 0.3357591972893468, -2.5439807400740557, -0.7057099848665609};
    private static double[] out3 = {1.0, 1.0};
    private static double[] in4 = {0.023097143438005265, -0.15991460968176413, -0.17862306450668003, -0.007500937534677424, 1.0234705876881915, 0.08322367993396002, 0.011924341315634754, 1.6190691126381263, -0.07633568942382353, -0.5532365778043495, 0.766196087052136, 0.016322103084103073, -1.1401225465666576, 0.36080065789992544, -0.10780277954227245, -0.7785378606408903, -0.17007090514848397, -0.2532023879511517, -0.6390630338820892, -0.33434594352904984, -0.2875635796955852, 0.5500168438762222, 0.759913838742787, 0.15013599689376, 1.0488679494227893, 0.3508539735789273, 0.21002356594348212, 1.088031447076879, -0.260880403048515, 0.04806414001709384, 0.9385525211593425, -0.4236045471780768, -0.0061898833638388785, -0.21882128225286546, -0.3977915655639124, -0.29063739916128334, -0.34656150963835886, -1.6844121205334157, -0.3277108266699993, -0.3305375341060913, -2.6357503845762826, -0.6030041887593258, 0.27875615253679503, -0.41263480025931687, -0.1920345977962192, 0.28260950260729645, -1.6582707824329719, -0.30071162228785514, 0.3568230358072914, -2.548053985856544, -0.718689850996125};
    private static double[] out4 = {1.0, 1.0};


}
